<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuzzy sets • BaseSet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fuzzy sets">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BaseSet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced.html">Advanced examples</a>
    </li>
    <li>
      <a href="../articles/basic.html">About BaseSet</a>
    </li>
    <li>
      <a href="../articles/fuzzy.html">Fuzzy sets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/llrs/BaseSet">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Fuzzy sets</h1>
                        <h4 class="author">Lluís Revilla</h4>
            <address class="author_afil">
      August Pi i Sunyer Biomedical Research Institute (IDIBAPS); Liver Unit, Hospital Clinic<br><a class="author_email" href="mailto:#"></a><a href="mailto:lluis.revilla@gmail.com">lluis.revilla@gmail.com</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/llrs/BaseSet/blob/master/vignettes/fuzzy.Rmd"><code>vignettes/fuzzy.Rmd</code></a></small>
      <div class="hidden name"><code>fuzzy.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Describes the fuzzy sets, interpretation and how to work with them.
    </div>
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>This vignettes supposes that you already read the “About Set” vignette This vignette explains what are the fuzzy sets and how to use them. As all methods for “normal” sets are available for fuzzy sets this vignette focuses on how to create, use them.</p>
</div>
<div id="creating-a-fuzzy-set" class="section level1">
<h1 class="hasAnchor">
<a href="#creating-a-fuzzy-set" class="anchor"></a>Creating a fuzzy set</h1>
<p>To create a fuzzy set you need to have a column named “fuzzy” if you create it from a data.frame. This column is restricted to a numeric value between 0 and 1. The value indicates the strength (or probability) of the relationship between the element and the set.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">4567</span>) <span class="co"># To be able to have exact replicates</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">relations &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"A"</span>, <span class="dv">5</span>), <span class="st">"B"</span>, <span class="st">"C"</span>),</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                          <span class="dt">elements =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(letters[<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="dv">6</span>)], letters[<span class="dv">6</span>]),</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                          <span class="dt">fuzzy =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">7</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">fuzzy_set &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidySet.html">tidySet</a></span>(relations)</a></code></pre></div>
</div>
<div id="working-with-fuzzy-sets" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-fuzzy-sets" class="anchor"></a>Working with fuzzy sets</h1>
<p>We can work with fuzzy sets as we do with normal sets. But if you remember that at the end of the vignette we used an Important column now this is already included, which allows us to use this information for union and intersection methods:</p>
<div id="union" class="section level2">
<h2 class="hasAnchor">
<a href="#union" class="anchor"></a>Union</h2>
<p>You can make a union of two sets present on the same object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">BaseSet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BaseSet/man/union.html">union</a></span>(fuzzy_set, <span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"C"</span>, <span class="st">"B"</span>), <span class="dt">name =</span> <span class="st">"D"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 1        f    D 0.7307312</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">BaseSet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BaseSet/man/union.html">union</a></span>(fuzzy_set, <span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"C"</span>, <span class="st">"B"</span>), <span class="dt">name =</span>  <span class="st">"D"</span>, <span class="dt">FUN =</span> <span class="st">"mean"</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 1        f    D 0.5040313</span></a></code></pre></div>
<p>Observe the fuzziness on the resulting set has changed (on the traditional sets it doesn’t matter)</p>
</div>
<div id="intersection" class="section level2">
<h2 class="hasAnchor">
<a href="#intersection" class="anchor"></a>Intersection</h2>
<p>We can do the same with the intersection</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/intersection.html">intersection</a></span>(fuzzy_set, <span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="dt">keep =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; 1        a  A∩B 0.2309186</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; 2        b  A∩B 0.7412554</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 3        c  A∩B 0.1833834</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 4        d  A∩B 0.4221682</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 5        e  A∩B 0.5996399</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 6        f  A∩B 0.2773313</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw"><a href="../reference/intersection.html">intersection</a></span>(fuzzy_set, <span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="dt">keep =</span> <span class="ot">FALSE</span>, <span class="dt">FUN =</span> <span class="st">"mean"</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; 1        a  A∩B 0.2309186</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; 2        b  A∩B 0.7412554</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; 3        c  A∩B 0.1833834</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; 4        d  A∩B 0.4221682</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; 5        e  A∩B 0.5996399</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; 6        f  A∩B 0.2773313</span></a></code></pre></div>
<p>But in this example we don’t see any difference on the calculated values.</p>
</div>
<div id="complement" class="section level2">
<h2 class="hasAnchor">
<a href="#complement" class="anchor"></a>Complement</h2>
<p>We can look for the complement of one or several sets:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/complement_set.html">complement_set</a></span>(fuzzy_set, <span class="dt">sets =</span> <span class="st">"A"</span>, <span class="dt">keep =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; 1        a   ∁A 0.7690814</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 2        b   ∁A 0.2587446</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 3        c   ∁A 0.8166166</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 4        d   ∁A 0.5778318</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 5        e   ∁A 0.4003601</span></a></code></pre></div>
<p>Note that the values of the complement are <code>1-fuzzy</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">fuzzy_set <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sets <span class="op">==</span><span class="st"> "A"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; 1        a    A 0.2309186</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 2        b    A 0.7412554</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 3        c    A 0.1833834</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 4        d    A 0.4221682</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 5        e    A 0.5996399</span></a></code></pre></div>
</div>
<div id="subtract" class="section level2">
<h2 class="hasAnchor">
<a href="#subtract" class="anchor"></a>Subtract</h2>
<p>This is the equivalent of <code>setdiff</code>, but clearer:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/subtract.html">subtract</a></span>(fuzzy_set, <span class="dt">set_in =</span> <span class="st">"A"</span>, <span class="dt">not_in =</span> <span class="st">"B"</span>, <span class="dt">keep =</span> <span class="ot">FALSE</span>, <span class="dt">name =</span> <span class="st">"A-B"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; 1        a  A-B 0.2309186</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; 2        b  A-B 0.7412554</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; 3        c  A-B 0.1833834</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; 4        d  A-B 0.4221682</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; 5        e  A-B 0.5996399</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co"># Or the opposite B-A, but using the default name:</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw"><a href="../reference/subtract.html">subtract</a></span>(fuzzy_set, <span class="dt">set_in =</span> <span class="st">"B"</span>, <span class="dt">not_in =</span> <span class="st">"A"</span>, <span class="dt">keep =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 1        f  B∖A 0.2773313</span></a></code></pre></div>
<p>Note that here there is also a subtraction of the fuzzy value.</p>
</div>
</div>
<div id="sizes" class="section level1">
<h1 class="hasAnchor">
<a href="#sizes" class="anchor"></a>Sizes</h1>
<p>Note that here the size of a set is not fixed:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/set_size.html">set_size</a></span>(fuzzy_set)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;    sets size probability</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; 1     A    0 0.037593610</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; 2     A    1 0.211200558</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; 3     A    2 0.384150899</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; 4     A    3 0.278302802</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 5     A    4 0.080805868</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 6     A    5 0.007946263</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 7     B    0 0.722668660</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 8     B    1 0.277331340</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 9     C    0 0.269268826</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; 10    C    1 0.730731174</span></a></code></pre></div>
<p>Or an element can be in 0 sets:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/element_size.html">element_size</a></span>(fuzzy_set)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;    elements size probability</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; 1         a    0   0.7690814</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 2         a    1   0.2309186</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 3         b    0   0.2587446</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 4         b    1   0.7412554</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 5         c    0   0.8166166</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 6         c    1   0.1833834</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 7         d    0   0.5778318</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 8         d    1   0.4221682</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 9         e    0   0.4003601</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 10        e    1   0.5996399</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 11        f    0   0.1945921</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; 12        f    1   0.6027532</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; 13        f    2   0.2026547</span></a></code></pre></div>
<p>In this example we can see that it is more probable that the element A is not present than the element f being present in one set.</p>
</div>
<div id="interpretation" class="section level1">
<h1 class="hasAnchor">
<a href="#interpretation" class="anchor"></a>Interpretation</h1>
<p>Let’s dive a bit in the interpretation.</p>
<p>Imagine you have your experiment where you collected data from a sample of cells for each cell (our elements). Then you used some program to classify which type of cell it is (delta endothelial, alpha, beta), this are our sets. The software returns a score (between 0 and 1) for each type it has, the higher the more confident it is of the assignment, which is our fuzzy value:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">sc_classification &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">elements =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"D2ex_1"</span>, <span class="st">"D2ex_10"</span>, <span class="st">"D2ex_11"</span>, <span class="st">"D2ex_12"</span>, <span class="st">"D2ex_13"</span>, <span class="st">"D2ex_14"</span>, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">               <span class="st">"D2ex_15"</span>, <span class="st">"D2ex_16"</span>, <span class="st">"D2ex_17"</span>, <span class="st">"D2ex_18"</span>, <span class="st">"D2ex_1"</span>, <span class="st">"D2ex_10"</span>, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">               <span class="st">"D2ex_11"</span>, <span class="st">"D2ex_12"</span>, <span class="st">"D2ex_13"</span>, <span class="st">"D2ex_14"</span>, <span class="st">"D2ex_15"</span>, <span class="st">"D2ex_16"</span>,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">               <span class="st">"D2ex_17"</span>, <span class="st">"D2ex_18"</span>, <span class="st">"D2ex_1"</span>, <span class="st">"D2ex_10"</span>, <span class="st">"D2ex_11"</span>, <span class="st">"D2ex_12"</span>, </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">               <span class="st">"D2ex_13"</span>, <span class="st">"D2ex_14"</span>, <span class="st">"D2ex_15"</span>, <span class="st">"D2ex_16"</span>, <span class="st">"D2ex_17"</span>, <span class="st">"D2ex_18"</span>, </a>
<a class="sourceLine" id="cb9-7" data-line-number="7">               <span class="st">"D2ex_1"</span>, <span class="st">"D2ex_10"</span>, <span class="st">"D2ex_11"</span>, <span class="st">"D2ex_12"</span>, <span class="st">"D2ex_13"</span>, <span class="st">"D2ex_14"</span>, </a>
<a class="sourceLine" id="cb9-8" data-line-number="8">               <span class="st">"D2ex_15"</span>, <span class="st">"D2ex_16"</span>, <span class="st">"D2ex_17"</span>, <span class="st">"D2ex_18"</span>), </a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  <span class="dt">sets =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, </a>
<a class="sourceLine" id="cb9-10" data-line-number="10">           <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"alpha"</span>, <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">           <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">           <span class="st">"endothel"</span>, <span class="st">"endothel"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, </a>
<a class="sourceLine" id="cb9-13" data-line-number="13">           <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"delta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, </a>
<a class="sourceLine" id="cb9-14" data-line-number="14">           <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>, <span class="st">"beta"</span>), </a>
<a class="sourceLine" id="cb9-15" data-line-number="15">  <span class="dt">fuzzy =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.18</span>, <span class="fl">0.169</span>, <span class="fl">0.149</span>, <span class="fl">0.192</span>, <span class="fl">0.154</span>, <span class="fl">0.161</span>, <span class="fl">0.169</span>, <span class="fl">0.197</span>, <span class="fl">0.162</span>, <span class="fl">0.201</span>, </a>
<a class="sourceLine" id="cb9-16" data-line-number="16">            <span class="fl">0.215</span>, <span class="fl">0.202</span>, <span class="fl">0.17</span>, <span class="fl">0.227</span>, <span class="fl">0.196</span>, <span class="fl">0.215</span>, <span class="fl">0.161</span>, <span class="fl">0.195</span>, <span class="fl">0.178</span>, </a>
<a class="sourceLine" id="cb9-17" data-line-number="17">            <span class="fl">0.23</span>, <span class="fl">0.184</span>, <span class="fl">0.172</span>, <span class="fl">0.153</span>, <span class="fl">0.191</span>, <span class="fl">0.156</span>, <span class="fl">0.167</span>, <span class="fl">0.165</span>, <span class="fl">0.184</span>, </a>
<a class="sourceLine" id="cb9-18" data-line-number="18">            <span class="fl">0.162</span>, <span class="fl">0.194</span>, <span class="fl">0.197</span>, <span class="fl">0.183</span>, <span class="fl">0.151</span>, <span class="fl">0.208</span>, <span class="fl">0.16</span>, <span class="fl">0.169</span>, <span class="fl">0.169</span>, </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">            <span class="fl">0.2</span>, <span class="fl">0.154</span>, <span class="fl">0.208</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sc_classification)</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt;   elements  sets fuzzy</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; 1   D2ex_1 alpha 0.180</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; 2  D2ex_10 alpha 0.169</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; 3  D2ex_11 alpha 0.149</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; 4  D2ex_12 alpha 0.192</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; 5  D2ex_13 alpha 0.154</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; 6  D2ex_14 alpha 0.161</span></a></code></pre></div>
<p>Our question is which type of cells did we have on the original sample? We can easily answer this by looking at the relations that have higher confidence of the relationship for each cell.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">sc_classification &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidySet.html">tidySet</a></span>(sc_classification)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">cells_assigned &lt;-<span class="st"> </span>sc_classification <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/activate.html">activate</a></span>(<span class="st">"relations"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(elements) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(fuzzy <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(fuzzy))</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">cells_assigned</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; # A tibble: 11 x 3</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; # Groups:   elements [10]</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;    elements sets     fuzzy</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  1 D2ex_15  alpha    0.169</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  2 D2ex_1   endothel 0.215</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  3 D2ex_10  endothel 0.202</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  4 D2ex_11  endothel 0.17 </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;  5 D2ex_12  endothel 0.227</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;  6 D2ex_13  endothel 0.196</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;  7 D2ex_14  endothel 0.215</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt;  8 D2ex_17  endothel 0.178</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt;  9 D2ex_18  endothel 0.23 </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; 10 D2ex_15  beta     0.169</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; 11 D2ex_16  beta     0.2</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co"># See how many cells of each type do we have</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23">cells_assigned <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(sets) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">  </span><span class="kw">count</span>()</a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; # Groups:   sets [3]</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt;   sets         n</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt;   &lt;chr&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; 1 alpha        1</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; 2 beta         2</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; 3 endothel     8</span></a></code></pre></div>
<p>Now we know which is the cell type most probable for each cell, and how much of each type do we have. Let’s see how many cells of each type we are more likely to get:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sample_cells &lt;-<span class="st"> </span>sc_classification <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/set_size.html">set_size</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(sets) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(probability <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(probability))</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">sample_cells</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; # A tibble: 4 x 3</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; # Groups:   sets [4]</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;   sets      size probability</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; 1 alpha        1       0.313</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; 2 beta         1       0.302</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; 3 delta        1       0.313</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; 4 endothel     2       0.303</span></a></code></pre></div>
<p>And we can see that there are 1 alpha cells, 1 beta cells, 1 delta cells, 2 endothel cells,. But this doesn’t make sense, because there must be some cell misclassification: we have only 10 cells in this example but there are 5 cells predicted for these types:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/nElements.html">nElements</a></span>(sc_classification) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sample_cells<span class="op">$</span>size)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>Ideally the predicted number of cells per type and the cells with higher confidence about the type should match.</p>
<p>We can also look the other way around: How good is the prediction of a cell type for each cell?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">cells_type &lt;-<span class="st"> </span>sc_classification <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/element_size.html">element_size</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(elements) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(probability <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(probability))</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">cells_type</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; # A tibble: 10 x 3</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; # Groups:   elements [10]</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;    elements  size probability</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;    &lt;chr&gt;    &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;  1 D2ex_1       0       0.422</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;  2 D2ex_10      0       0.449</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt;  3 D2ex_11      0       0.508</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;  4 D2ex_12      1       0.412</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt;  5 D2ex_13      0       0.482</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt;  6 D2ex_14      0       0.456</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt;  7 D2ex_15      0       0.484</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt;  8 D2ex_16      0       0.422</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt;  9 D2ex_17      0       0.488</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; 10 D2ex_18      1       0.414</span></a></code></pre></div>
<p>We can see that for most cells the most probable cell type is not present (we don’t know the type of cell), and some cells could be classified in more than 1 cell type.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sc_classification <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/element_size.html">element_size</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(elements <span class="op">==</span><span class="st"> "D2ex_18"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw">desc</span>(probability))</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt;   elements size probability</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 1  D2ex_18    1 0.413778624</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 2  D2ex_18    0 0.392733301</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 3  D2ex_18    2 0.163108322</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; 4  D2ex_18    3 0.028514280</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; 5  D2ex_18    4 0.001865473</span></a></code></pre></div>
<p>And as we can see it is mostly as likely to be on the three cell types than in none of the cell types present.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li><a href="#creating-a-fuzzy-set">Creating a fuzzy set</a></li>
      <li>
<a href="#working-with-fuzzy-sets">Working with fuzzy sets</a><ul class="nav nav-pills nav-stacked">
<li><a href="#union">Union</a></li>
      <li><a href="#intersection">Intersection</a></li>
      <li><a href="#complement">Complement</a></li>
      <li><a href="#subtract">Subtract</a></li>
      </ul>
</li>
      <li><a href="#sizes">Sizes</a></li>
      <li><a href="#interpretation">Interpretation</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lluís  Revilla Sancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

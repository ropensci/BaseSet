<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced examples • BaseSet</title>
<!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced examples">
<meta name="robots" content="noindex">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">BaseSet</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.9.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../articles/BaseSet.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">Advanced examples</a></li>
    <li><a class="dropdown-item" href="../articles/fuzzy.html">Fuzzy sets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://llrs.dev/post/2023/08/23/baseset-0-9-0/">BaseSet 0.9.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/BaseSet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced examples</h1>
                        <h4 data-toc-skip class="author">Lluís
Revilla</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:lluis.revilla@gmail.com" class="email">lluis.revilla@gmail.com</a>
      
                  
            <h4 data-toc-skip class="date">2025 Feb 12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/BaseSet/blob/main/vignettes/advanced.Rmd" class="external-link"><code>vignettes/advanced.Rmd</code></a></small>
      <div class="d-none name"><code>advanced.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette assumes you are familiar with set operations from
      the basic vignette.</p>
    </div>
    
<div class="section level2">
<h2 id="initial-setup">Initial setup<a class="anchor" aria-label="anchor" href="#initial-setup"></a>
</h2>
<p>To show compatibility with tidy workflows we will use magrittr pipe
operator and the dplyr verbs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/BaseSet">"BaseSet"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="human-gene-ontology">Human gene ontology<a class="anchor" aria-label="anchor" href="#human-gene-ontology"></a>
</h2>
<p>We will explore the genes with assigned gene ontology terms. These
terms describe what is the process and role of the genes. The links are
annotated with different <a href="https://geneontology.org/docs/guide-go-evidence-codes/" class="external-link">evidence
codes</a> to indicate how such annotation is supported.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We load some libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"org.Hs.eg.db"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"GO.db"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Prepare the data </span></span>
<span><span class="va">h2GO_TS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidySet.html">tidySet</a></span><span class="op">(</span><span class="va">org.Hs.egGO</span><span class="op">)</span></span>
<span><span class="va">h2GO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">org.Hs.egGO</span><span class="op">)</span></span></code></pre></div>
<p>We can now explore if there are differences in evidence usage for
each ontology in gene ontology:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://forcats.tidyverse.org/" class="external-link">"forcats"</a></span>, include.only <span class="op">=</span> <span class="st">"fct_reorder2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">h2GO</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Evidence</span>, <span class="va">Ontology</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Freq"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Evidence <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder2</a></span><span class="op">(</span><span class="va">Evidence</span>, <span class="va">Ontology</span>, <span class="op">-</span><span class="va">Freq</span><span class="op">)</span>,</span>
<span>           Ontology <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html" class="external-link">case_match</a></span><span class="op">(</span><span class="va">Ontology</span>,</span>
<span>                                 <span class="st">"CC"</span> <span class="op">~</span> <span class="st">"Cellular Component"</span>,</span>
<span>                                 <span class="st">"MF"</span> <span class="op">~</span> <span class="st">"Molecular Function"</span>,</span>
<span>                                 <span class="st">"BP"</span> <span class="op">~</span> <span class="st">"Biological Process"</span>,</span>
<span>                                 .default <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Evidence</span>, <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">Ontology</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         title <span class="op">=</span> <span class="st">"Evidence codes for each ontology"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/evidence_ontology-1.png" alt="Horizontal bar plot with the number of evidence code per ontology." width="700"></p>
<p>We can see that biological process are more likely to be defined by
IMP evidence code that means inferred from mutant phenotype. While
inferred from physical interaction (IPI) is almost exclusively used to
assign molecular functions.</p>
<p>This graph doesn’t consider that some relationships are better
annotated than other:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h2GO_TS</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/relations.html">relations</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">elements</span>, <span class="va">sets</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"Annotations"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Annotations</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Annotations</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Evidence codes"</span>, y <span class="op">=</span> <span class="st">"Annotations"</span>, </span>
<span>         title <span class="op">=</span> <span class="st">"Evidence codes for each annotation"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"in human"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/nEvidence_plot-1.png" alt="Bar plot with the number of relationships that with a given number of evidences: most only have 1 evidence code but some have up to 7" width="700"></p>
<p>We can see that mostly all the annotations are done with a single
evidence code. So far we have explored the code that it is related to a
gene but how many genes don’t have any annotation?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add all the genes and GO terms</span></span>
<span><span class="va">h2GO_TS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_elements.html">add_elements</a></span><span class="op">(</span><span class="va">h2GO_TS</span>, <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">keys</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/add_sets.html">add_sets</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^GO:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">keys</a></span><span class="op">(</span><span class="va">GO.db</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes_element</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/element_size.html">element_size</a></span><span class="op">(</span><span class="va">h2GO_TS</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_element</span><span class="op">$</span><span class="va">size</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 172480</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_element</span><span class="op">$</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20825</span></span>
<span></span>
<span><span class="va">sizes_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_size.html">set_size</a></span><span class="op">(</span><span class="va">h2GO_TS</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_set</span><span class="op">$</span><span class="va">size</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 22261</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_set</span><span class="op">$</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18678</span></span></code></pre></div>
<p>So we can see that both there are more genes without annotation and
more gene ontology terms without a (direct) gene annotated.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sizes_element</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# sets per element"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/plots_GO-1.png" alt="Histogram of number of sets per element: there are many genes on many ontologies." width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sizes_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# elements per set"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/plots_GO-2.png" alt="Histogram of number of elements per set: There is one set that is huge but then there many than have few elements." width="700"></p>
<p>As you can see on the second plot we have very large values but that
are on associated on many genes:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sizes_set</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;          sets  size probability Ontology</span></span>
<span><span class="co">#&gt; 1  GO:0005515 13668           1       MF</span></span>
<span><span class="co">#&gt; 2  GO:0005634  5736           1       CC</span></span>
<span><span class="co">#&gt; 3  GO:0005829  5468           1       CC</span></span>
<span><span class="co">#&gt; 4  GO:0005886  5286           1       CC</span></span>
<span><span class="co">#&gt; 5  GO:0005737  5253           1       CC</span></span>
<span><span class="co">#&gt; 6  GO:0005654  3933           1       CC</span></span>
<span><span class="co">#&gt; 7  GO:0016020  3272           1       CC</span></span>
<span><span class="co">#&gt; 8  GO:0046872  2400           1       MF</span></span>
<span><span class="co">#&gt; 9  GO:0070062  2213           1       CC</span></span>
<span><span class="co">#&gt; 10 GO:0005576  1995           1       CC</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-fuzzy-values">Using fuzzy values<a class="anchor" aria-label="anchor" href="#using-fuzzy-values"></a>
</h3>
<p>This could radically change if we used fuzzy values. We could assign
a fuzzy value to each evidence code given the lowest fuzzy value for the
<a href="https://wiki.geneontology.org/index.php/Inferred_from_Electronic_Annotation_(IEA)" class="external-link">IEA
(Inferred from Electronic Annotation)</a> evidence. The highest values
would be for evidence codes coming from experiments or alike.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nr</span> <span class="op">&lt;-</span> <span class="va">h2GO_TS</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/relations.html">relations</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sets</span>, <span class="va">Evidence</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fuzzy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html" class="external-link">case_match</a></span><span class="op">(</span><span class="va">Evidence</span>,</span>
<span>                              <span class="st">"EXP"</span> <span class="op">~</span> <span class="fl">0.9</span>,</span>
<span>                              <span class="st">"IDA"</span> <span class="op">~</span> <span class="fl">0.8</span>,</span>
<span>                              <span class="st">"IPI"</span> <span class="op">~</span> <span class="fl">0.8</span>,</span>
<span>                              <span class="st">"IMP"</span> <span class="op">~</span> <span class="fl">0.75</span>,</span>
<span>                              <span class="st">"IGI"</span> <span class="op">~</span> <span class="fl">0.7</span>,</span>
<span>                              <span class="st">"IEP"</span> <span class="op">~</span> <span class="fl">0.65</span>,</span>
<span>                              <span class="st">"HEP"</span> <span class="op">~</span> <span class="fl">0.6</span>,</span>
<span>                              <span class="st">"HDA"</span> <span class="op">~</span> <span class="fl">0.6</span>,</span>
<span>                              <span class="st">"HMP"</span> <span class="op">~</span> <span class="fl">0.5</span>,</span>
<span>                              <span class="st">"IBA"</span> <span class="op">~</span> <span class="fl">0.45</span>,</span>
<span>                              <span class="st">"ISS"</span> <span class="op">~</span> <span class="fl">0.4</span>,</span>
<span>                              <span class="st">"ISO"</span> <span class="op">~</span> <span class="fl">0.32</span>,</span>
<span>                              <span class="st">"ISA"</span> <span class="op">~</span> <span class="fl">0.32</span>,</span>
<span>                              <span class="st">"ISM"</span> <span class="op">~</span> <span class="fl">0.3</span>,</span>
<span>                              <span class="st">"RCA"</span> <span class="op">~</span> <span class="fl">0.2</span>,</span>
<span>                              <span class="st">"TAS"</span> <span class="op">~</span> <span class="fl">0.15</span>,</span>
<span>                              <span class="st">"NAS"</span> <span class="op">~</span> <span class="fl">0.1</span>,</span>
<span>                              <span class="st">"IC"</span> <span class="op">~</span> <span class="fl">0.02</span>,</span>
<span>                              <span class="st">"ND"</span> <span class="op">~</span> <span class="fl">0.02</span>,</span>
<span>                              <span class="st">"IEA"</span> <span class="op">~</span> <span class="fl">0.01</span>,</span>
<span>                              .default <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>sets <span class="op">=</span> <span class="st">"sets"</span>, elements <span class="op">=</span> <span class="st">"Evidence"</span>, fuzzy <span class="op">=</span> <span class="va">fuzzy</span><span class="op">)</span></span></code></pre></div>
<p>We have several evidence codes for the same ontology, this would
result on different fuzzy values for each relation. Instead, we extract
this and add them as new sets and elements and add an extra column to
classify what are those elements:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="va">h2GO_TS</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/relations.html">relations</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Evidence</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/tidySet.html">tidySet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/mutate_.html">mutate_element</a></span><span class="op">(</span>Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^[0-9]+$"</span>, <span class="va">elements</span><span class="op">)</span>, <span class="st">"gene"</span>, <span class="st">"evidence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we can see which gene ontologies are more supported by the
evidence:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Type</span> <span class="op">!=</span> <span class="st">"Gene"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/cardinality.html">cardinality</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">cardinality</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         sets cardinality</span></span>
<span><span class="co">#&gt; 1 GO:0005515    13670.90</span></span>
<span><span class="co">#&gt; 2 GO:0005634     5742.00</span></span>
<span><span class="co">#&gt; 3 GO:0005829     5472.78</span></span>
<span><span class="co">#&gt; 4 GO:0005886     5291.60</span></span>
<span><span class="co">#&gt; 5 GO:0005737     5258.10</span></span>
<span><span class="co">#&gt; 6 GO:0005654     3936.26</span></span></code></pre></div>
<p>Surprisingly the most supported terms are protein binding, nucleus
and cytosol. I would expect them to be the top three terms for cellular
component, biological function and molecular function.</p>
<p>Calculating set sizes would be interesting but it requires computing
a big number of combinations that make it last long and require many
memory available.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sets</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO:0008152"</span>, <span class="st">"GO:0003674"</span>, <span class="st">"GO:0005575"</span><span class="op">)</span>,</span>
<span>           <span class="va">Type</span> <span class="op">!=</span> <span class="st">"gene"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_size.html">set_size</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         sets size probability</span></span>
<span><span class="co">#&gt; 1 GO:0003674    0        0.98</span></span>
<span><span class="co">#&gt; 2 GO:0003674    1        0.02</span></span>
<span><span class="co">#&gt; 3 GO:0005575    0        0.98</span></span>
<span><span class="co">#&gt; 4 GO:0005575    1        0.02</span></span></code></pre></div>
<p>Unexpectedly there is few evidence for the main terms:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">go_terms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO:0008152"</span>, <span class="st">"GO:0003674"</span>, <span class="st">"GO:0005575"</span><span class="op">)</span></span>
<span><span class="va">ts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sets</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">go_terms</span> <span class="op">&amp;</span> <span class="va">Type</span> <span class="op">!=</span> <span class="st">"gene"</span><span class="op">)</span> </span>
<span><span class="co">#&gt;   elements       sets fuzzy     Type</span></span>
<span><span class="co">#&gt; 1       ND GO:0005575  0.02 evidence</span></span>
<span><span class="co">#&gt; 2       ND GO:0003674  0.02 evidence</span></span></code></pre></div>
<p>In fact those terms are arbitrarily decided or inferred from
electronic analysis.</p>
</div>
</div>
<div class="section level2">
<h2 id="human-pathways">Human pathways<a class="anchor" aria-label="anchor" href="#human-pathways"></a>
</h2>
<p>Now we will repeat the same analysis with pathways:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We load some libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"reactome.db"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare the data (is easier, there isn't any ontoogy or evidence column)</span></span>
<span><span class="va">h2p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">reactomeEXTID2PATHID</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">h2p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sets"</span>, <span class="st">"elements"</span><span class="op">)</span></span>
<span><span class="co"># Filter only for human pathways</span></span>
<span><span class="va">h2p</span> <span class="op">&lt;-</span> <span class="va">h2p</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^R-HSA-"</span>, <span class="va">h2p</span><span class="op">$</span><span class="va">sets</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># There are duplicate relations with different evidence codes!!: </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">h2p</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elements"</span>, <span class="st">"sets"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Mode   FALSE    TRUE </span></span>
<span><span class="co">#&gt; logical  131256   14794</span></span>
<span><span class="va">h2p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">h2p</span><span class="op">)</span></span>
<span><span class="co"># Create a TidySet and </span></span>
<span><span class="va">h2p_TS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidySet.html">tidySet</a></span><span class="op">(</span><span class="va">h2p</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># Add all the genes </span></span>
<span>    <span class="fu"><a href="../reference/add_elements.html">add_elements</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">keys</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have everything ready we can start measuring some
things…</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sizes_element</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/element_size.html">element_size</a></span><span class="op">(</span><span class="va">h2p_TS</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_element</span><span class="op">$</span><span class="va">size</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 182159</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sizes_element</span><span class="op">$</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11422</span></span>
<span></span>
<span><span class="va">sizes_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_size.html">set_size</a></span><span class="op">(</span><span class="va">h2p_TS</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can see there are more genes without pathways than genes with
pathways.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sizes_element</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# sets per element"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_log10(): <span style="color: #00BB00;">log-10</span> transformation introduced</span></span>
<span><span class="co">#&gt; infinite values.</span></span>
<span><span class="co">#&gt; Warning: Removed 284 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_bar()`).</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/pathways_plots-1.png" alt="Genes per pathway." width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sizes_set</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"# elements per set"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_log10(): <span style="color: #00BB00;">log-10</span> transformation introduced</span></span>
<span><span class="co">#&gt; infinite values.</span></span>
<span><span class="co">#&gt; Warning: Removed 2358 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_bar()`).</span></span></code></pre></div>
<p><img src="advanced_files/figure-html/pathways_plots-2.png" alt="Pathway per gene." width="700"></p>
<p>As you can see on the second plot we have very large values but that
are on associated on many genes:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sizes_set</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;             sets size probability</span></span>
<span><span class="co">#&gt; 1   R-HSA-162582 2613           1</span></span>
<span><span class="co">#&gt; 2  R-HSA-1430728 2189           1</span></span>
<span><span class="co">#&gt; 3   R-HSA-392499 2087           1</span></span>
<span><span class="co">#&gt; 4  R-HSA-1643685 2080           1</span></span>
<span><span class="co">#&gt; 5   R-HSA-168256 2068           1</span></span>
<span><span class="co">#&gt; 6    R-HSA-74160 1569           1</span></span>
<span><span class="co">#&gt; 7   R-HSA-597592 1474           1</span></span>
<span><span class="co">#&gt; 8  R-HSA-1266738 1409           1</span></span>
<span><span class="co">#&gt; 9    R-HSA-73857 1373           1</span></span>
<span><span class="co">#&gt; 10 R-HSA-5663205 1273           1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] reactome.db_1.89.0   forcats_1.0.0        ggplot2_3.5.1       </span></span>
<span><span class="co">#&gt;  [4] GO.db_3.20.0         org.Hs.eg.db_3.20.0  AnnotationDbi_1.68.0</span></span>
<span><span class="co">#&gt;  [7] IRanges_2.40.1       S4Vectors_0.44.0     Biobase_2.66.0      </span></span>
<span><span class="co">#&gt; [10] BiocGenerics_0.52.0  dplyr_1.1.4          BaseSet_0.9.0.9002  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] KEGGREST_1.46.0         gtable_0.3.6            xfun_0.50              </span></span>
<span><span class="co">#&gt;  [4] bslib_0.9.0             vctrs_0.6.5             tools_4.4.2            </span></span>
<span><span class="co">#&gt;  [7] generics_0.1.3          tibble_3.2.1            RSQLite_2.3.9          </span></span>
<span><span class="co">#&gt; [10] blob_1.2.4              pkgconfig_2.0.3         desc_1.4.3             </span></span>
<span><span class="co">#&gt; [13] graph_1.84.1            lifecycle_1.0.4         GenomeInfoDbData_1.2.13</span></span>
<span><span class="co">#&gt; [16] farver_2.1.2            compiler_4.4.2          textshaping_1.0.0      </span></span>
<span><span class="co">#&gt; [19] Biostrings_2.74.1       munsell_0.5.1           GenomeInfoDb_1.42.3    </span></span>
<span><span class="co">#&gt; [22] htmltools_0.5.8.1       sass_0.4.9              yaml_2.3.10            </span></span>
<span><span class="co">#&gt; [25] pkgdown_2.1.1           pillar_1.10.1           crayon_1.5.3           </span></span>
<span><span class="co">#&gt; [28] jquerylib_0.1.4         cachem_1.1.0            tidyselect_1.2.1       </span></span>
<span><span class="co">#&gt; [31] digest_0.6.37           labeling_0.4.3          fastmap_1.2.0          </span></span>
<span><span class="co">#&gt; [34] grid_4.4.2              colorspace_2.1-1        cli_3.6.3              </span></span>
<span><span class="co">#&gt; [37] magrittr_2.0.3          XML_3.99-0.18           GSEABase_1.68.0        </span></span>
<span><span class="co">#&gt; [40] withr_3.0.2             UCSC.utils_1.2.0        scales_1.3.0           </span></span>
<span><span class="co">#&gt; [43] bit64_4.6.0-1           rmarkdown_2.29          XVector_0.46.0         </span></span>
<span><span class="co">#&gt; [46] httr_1.4.7              bit_4.5.0.1             ragg_1.3.3             </span></span>
<span><span class="co">#&gt; [49] png_0.1-8               memoise_2.0.1           evaluate_1.0.3         </span></span>
<span><span class="co">#&gt; [52] knitr_1.49              rlang_1.1.5             xtable_1.8-4           </span></span>
<span><span class="co">#&gt; [55] glue_1.8.0              DBI_1.2.3               annotate_1.84.0        </span></span>
<span><span class="co">#&gt; [58] jsonlite_1.8.9          R6_2.5.1                systemfonts_1.2.1      </span></span>
<span><span class="co">#&gt; [61] fs_1.6.5                zlibbioc_1.52.0</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>





  </body>
</html>
